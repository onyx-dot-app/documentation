---
title: "Send a Message to Onyx"
description: "Guide to send a message to Onyx"
icon: "bolt"
---

<Tip>
  Start with the simple API and move to the advanced flow when you need more control.
</Tip>

## Simple Chat Flow

*Send Message Simple API* is the quickest way to interact with Onyx programmatically.

This endpoint has fewer required parameters and returns a concise JSON payload described by `ChatBasicResponse`.

<Note>
  You must specify either a `chat_session_id` or a `persona_id` in your request.
</Note>

<CodeGroup>
  ```python Python expandable
  import requests

  API_BASE_URL = "https://cloud.onyx.app/api" # or your own domain
  API_KEY = "YOUR_KEY_HERE"

  headers = {
    "Authorization": f"Bearer {API_KEY}",
    "Content-Type": "application/json"
  }

  '''
  - To create a chat session, see the Full-featured Chat Flow guide below.
  - To find your persona_id, see the List Agents endpoint in the Agents API Reference.
  '''

  response = requests.post(
    f"{API_BASE_URL}/chat/send-message-simple-api",
    headers=headers,
    json={
      "message": "What is Onyx?",
      "persona_id": 0  # The default Onyx Search Agent (int)
    }
  )

  data = response.json()
  answer = data.get("answer")
  answer_citationless = data.get("answer_citationless")
  message_id = data.get("message_id")
  docs = data.get("top_documents") or []
  top_documents = [
    {
      "id": doc.get("document_id"),
      "title": doc.get("semantic_identifier"),
      "link": doc.get("link")
    } for doc in docs
  ]
  cited_docs_map = data.get("cited_documents") or {}

  print(f"Answer: {answer}")
  print(f"Answer (citationless): {answer_citationless}")
  print(f"Message ID: {message_id}")
  print(f"Top Documents: {top_documents[:5]}") # Print top 5 documents
  print(f"Citations map: {cited_docs_map}")
  ```

  ```bash Shell expandable
  #!/bin/bash

  API_BASE_URL="https://cloud.onyx.app/api"
  API_KEY="YOUR_KEY_HERE"

  echo "Sending message to Onyx..."
  RESPONSE=$(curl -s -X POST "${API_BASE_URL}/chat/send-message-simple-api" \
    -H "Authorization: Bearer ${API_KEY}" \
    -H "Content-Type: application/json" \
    -d '{
    "message": "What is Onyx?",
    "persona_id": 0
  }')

  echo "Answer:"
  echo $RESPONSE | jq -r '.answer'

  echo -e "\nAnswer (citationless):"
  echo $RESPONSE | jq -r '.answer_citationless'

  echo -e "\nMessage ID:"
  echo $RESPONSE | jq -r '.message_id'

  echo -e "\nTop Documents:"
  echo $RESPONSE | jq '.top_documents | .[] | {id: .document_id, title: .semantic_identifier, link: .link}'
  ```
</CodeGroup>

## Advanced Chat Flow

Skip to the [Full Code](#full-code) section if you don't want the step-by-step guide.

<Steps>
  <Step title="Prepare your request">
    <CodeGroup>
      ```python Python
      import requests

      API_BASE_URL = "https://cloud.onyx.app/api" # or your own domain
      API_KEY = "YOUR_KEY_HERE"

      headers = {
      "Authorization": f"Bearer {API_KEY}",
      "Content-Type": "application/json"
      }
      ```

      ```bash Shell
      API_BASE_URL="https://cloud.onyx.app/api"
      API_KEY="YOUR_KEY_HERE"
      ```
    </CodeGroup>
  </Step>

  <Step title="Create a chat session">
    <CodeGroup>
      ```python Python
      session_response = requests.post(
      f"{API_BASE_URL}/chat/create-chat-session",
      headers=headers,
      json={
      "persona_id": 0, # The default Onyx Search Agent
      "description": "Onyx API Guide Chat Session"
      }
      )

      chat_session_id = session_response.json()["chat_session_id"]
      ```

      ```bash Shell
      CHAT_SESSION_RESPONSE=$(curl -s -X POST "${API_BASE_URL}/chat/create-chat-session" \
      -H "Authorization: Bearer ${API_KEY}" \
      -H "Content-Type: application/json" \
      -d '{
      "persona_id": 0,
      "description": "Onyx API Guide Chat Session"
      }')

      # Extract chat session ID (requires jq for JSON parsing)
      CHAT_SESSION_ID=$(echo $CHAT_SESSION_RESPONSE | jq -r '.chat_session_id')
      ```
    </CodeGroup>
  </Step>

  <Step title="Send message">
    <CodeGroup>
      ```python Python
      message_response = requests.post(
      f"{API_BASE_URL}/chat/send-message-simple-api",
      headers=headers,
      json={
      "chat_session_id": chat_session_id,
      "parent_message_id": None,
      "message": "What is Onyx?",
      "file_descriptors": [],
      "prompt_id": None,
      "search_doc_ids": [],
      "retrieval_options": {}
      }
      )
      ```

      ```bash Shell
      MESSAGE_RESPONSE=$(curl -s -X POST "${API_BASE_URL}/chat/send-message-simple-api" \
      -H "Authorization: Bearer ${API_KEY}" \
      -H "Content-Type: application/json" \
      -d "{
      \"chat_session_id\": \"${CHAT_SESSION_ID}\",
      \"parent_message_id\": null,
      \"message\": \"What is Onyx?\",
      \"file_descriptors\": [],
      \"prompt_id\": null,
      \"search_doc_ids\": [],
      \"retrieval_options\": {}
      }")
      ```
    </CodeGroup>
  </Step>

  <Step title="Parse response">
    <CodeGroup>
      ```python Python
      data = message_response.json()
      answer = data.get("answer")
      answer_citationless = data.get("answer_citationless")
      message_id = data.get("message_id")
      docs = data.get("top_documents") or []
      top_documents = [
      {
      "id": doc.get("document_id"),
      "title": doc.get("semantic_identifier"),
      "link": doc.get("link")
      } for doc in docs
      ]
      print(f"Answer: {answer}")
      print(f"Answer (citationless): {answer_citationless}")
      print(f"Message ID: {message_id}")
      print(f"Top Documents: {top_documents[:5]}")
      ```

      ```bash Shell
      echo "Response received:"
      echo $MESSAGE_RESPONSE

      ANSWER=$(echo $MESSAGE_RESPONSE | jq -r '.answer')
      ANSWER_CL=$(echo $MESSAGE_RESPONSE | jq -r '.answer_citationless')
      MESSAGE_ID=$(echo $MESSAGE_RESPONSE | jq -r '.message_id')
      echo "Answer: $ANSWER"
      echo "Answer (citationless): $ANSWER_CL"
      echo "Message ID: $MESSAGE_ID"

      echo "Top Documents:"
      echo $MESSAGE_RESPONSE | jq '.top_documents | .[] | {id: .document_id, title: .semantic_identifier, link: .link}'
      ```
    </CodeGroup>
  </Step>
</Steps>

#### Full Code

<CodeGroup>
  ```python Python expandable
  import requests

  API_BASE_URL = "https://cloud.onyx.app/api" # or your own domain
  API_KEY = "YOUR_KEY_HERE"

  headers = {
  "Authorization": f"Bearer {API_KEY}",
  "Content-Type": "application/json"
  }

  # Create a chat session
  session_response = requests.post(
  f"{API_BASE_URL}/chat/create-chat-session",
  headers=headers,
  json={
  "persona_id": 0, # The default Onyx Search Agent
  "description": "Onyx API Guide Chat Session"
  }
  )

  chat_session_id = session_response.json()["chat_session_id"]

  # Send message
  message_response = requests.post(
  f"{API_BASE_URL}/chat/send-message-simple-api",
  headers=headers,
  json={
  "chat_session_id": chat_session_id,
  "parent_message_id": None,
  "message": "What is Onyx?",
  "file_descriptors": [],
  "prompt_id": None,
  "search_doc_ids": [],
  "retrieval_options": {}
  }
  )

  # Parse response
  data = message_response.json()
  answer = data.get("answer")
  answer_citationless = data.get("answer_citationless")
  message_id = data.get("message_id")
  docs = data.get("top_documents") or []
  top_documents = [
  {
  "id": doc.get("document_id"),
  "title": doc.get("semantic_identifier"),
  "link": doc.get("link")
  } for doc in docs
  ]

  print(f"Answer: {answer}")
  print(f"Answer (citationless): {answer_citationless}")
  print(f"Message ID: {message_id}")
  print(f"Top Documents: {top_documents[:5]}")
  ```

  ```bash Shell expandable
  #!/bin/bash

  API_BASE_URL="https://cloud.onyx.app/api"
  API_KEY="YOUR_KEY_HERE"

  echo "Creating chat session..."
  CHAT_SESSION_RESPONSE=$(curl -s -X POST "${API_BASE_URL}/chat/create-chat-session" \
  -H "Authorization: Bearer ${API_KEY}" \
  -H "Content-Type: application/json" \
  -d '{
  "persona_id": 0,
  "description": "Onyx API Guide Chat Session"
  }')

  CHAT_SESSION_ID=$(echo $CHAT_SESSION_RESPONSE | jq -r '.chat_session_id')
  echo "Created chat session: $CHAT_SESSION_ID"

  echo "Sending message..."
  MESSAGE_RESPONSE=$(curl -s -X POST "${API_BASE_URL}/chat/send-message-simple-api" \
  -H "Authorization: Bearer ${API_KEY}" \
  -H "Content-Type: application/json" \
  -d "{
  \"chat_session_id\": \"${CHAT_SESSION_ID}\",
  \"parent_message_id\": null,
  \"message\": \"What is Onyx?\",
  \"file_descriptors\": [],
  \"prompt_id\": null,
  \"search_doc_ids\": [],
  \"retrieval_options\": {}
  }")

  echo "Answer:"
  echo $MESSAGE_RESPONSE | jq -r '.answer'

  echo -e "\nMessage ID:"
  echo $MESSAGE_RESPONSE | jq -r '.message_id'

  echo -e "\nTop Documents:"
  echo $MESSAGE_RESPONSE | jq '.top_documents | .[] | {id: .document_id, title: .semantic_identifier, link: .link}'
  ```
</CodeGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="Guide: Use the Ingestion API" icon="upload" href="/developers/guides/index_files_ingestion_api">
    Use the lightweight ingestion API to index documents
  </Card>

  <Card title="Guide: Create a Connector" icon="link" href="/developers/guides/create_connector">
    Learn how to create and configure Connectors programmatically
  </Card>
</CardGroup>
