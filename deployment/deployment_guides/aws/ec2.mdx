---
title: EC2
description: "Deploy Onyx on AWS EC2"
icon: "aws"
---

Using AWS EC2 is the recommended way of deploying Onyx. 
It is simple to set up and should meet the performance needs of 90% of organizations looking to use Onyx!

<Steps>
    <Step title="Create an EC2 instance">
        Create an EC2 instance with the appropriate resources. For this guide, we will use the recommended `m7g.xlarge` instance.
        <Note>
            Read our [Resourcing guide](/deployment/getting_started/resourcing) for more details.
        </Note>

        - Give your instance a descriptive name like `onyx-prod`
        - Select the `Amazon Linux 2023` AMI
        - Select the `64-bit (Arm)` architecture
        - Select the `m7g.xlarge` instance type
        - Select `Allow HTTPS traffic from the internet` in the *Network settings* section
        - Configure storage following the Resourcing Guide 

        <img className="rounded-image" src="/assets/deployment/ec2_create_instance.png" alt="EC2 Instance Creation" />

        <img className="rounded-image" src="/assets/deployment/ec2_https.png" alt="EC2 Security Group Configuration" />
    </Step>

    <Step title="Create the instance">
        Click **Launch instance** and then view your instance details. 
        
        <Tip>
            Save the **Public IPv4 address** of the instance!
        </Tip>

        <img className="rounded-image" src="/assets/deployment/ec2_ipv4.png" alt="EC2 Public IPv4 Address" />
    </Step>

  <Step title="Point domain to the instance">
    <Note>
        If you don't have a domain, buy one from a DNS provider like [GoDaddy](https://www.godaddy.com/) or just skip HTTPS for now.
    </Note>

    To point our domain to the new instance, we need to add an `A` and `CNAME` record to our DNS provider.

    <img className="rounded-image" src="/assets/deployment/arecord.png" alt="DNS A Record Configuration" />
    <img className="rounded-image" src="/assets/deployment/cname.png" alt="DNS CNAME Record Configuration" />
  </Step>

  <Step title="Install Onyx Requirements">
    Onyx requires `git`, `docker`, and `docker compose`. 
    
    To install these on Amazon Linux 2023, we can run the following:

    ```bash
    sudo yum update -y

    sudo yum install docker -y
    sudo service docker start

    sudo curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose
    sudo chmod +x /usr/local/bin/docker-compose

    sudo yum install git
    ```
  </Step>

  <Step title="Install and Configure Onyx">
    To install and configure Onyx, we'll need to clone the repo and set the necessary environment variables.

    ```bash
    git clone https://github.com/onyx-dot-app/onyx.git

    cd onyx/deployment/docker_compose
    cp .env.prod.template .env
    cp .env.nginx.template .env.nginx
    ```

    Fill out the `.env` and `.env.nginx` files:

    ```bash .env expandable
    WEB_DOMAIN=<YOUR_DOMAIN>  # Something like "onyx.app"

    # If your email is something like "chris@onyx.app", then this should be "onyx.app"
    # This prevents people outside your company from creating an account
    VALID_EMAIL_DOMAINS=<YOUR_COMPANIES_EMAIL_DOMAIN>

    # See our auth guides for options here
    AUTH_TYPE=
    ```

    ```bash .env.nginx
    DOMAIN=<YOUR_DOMAIN>  # Something like "onyx.app"
    ```
    
    Running the `init-letsencrypt.sh` script will get us a SSL certificate from letsencrypt and launch the Onyx stack.

    ```bash
    ./init-letsencrypt.sh
    ```
    
    If are skipping the HTTPS setup, start Onyx manually:
    
    ```bash
    docker-compose -f docker-compose.dev.yml -p onyx-stack up -d --build --force-recreate
    ```
    
    <Note>
        Give Onyx a few minutes to start up. 
        
        You can monitor the progress with `docker logs onyx-stack-api_server-1 -f`.
    </Note>

    You can access Onyx from the instance Public IPv4 or from the domain you set up earlier!
  </Step>
</Steps>

## Next Steps

<CardGroup cols={2}>
  <Card title="Configure Authentication" icon="shield-check" href="/deployment/authentication/basic">
    Set up authentication for your Onyx deployment with OAuth, OIDC, or SAML.
  </Card>
  <Card title="Environment Variables" icon="gear" href="/deployment/configuration/env_vars">
    Learn about all available configuration options for your Onyx deployment.
  </Card>
</CardGroup>