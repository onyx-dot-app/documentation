---
title: Anthropic
description: "Configure Anthropic Claude models for Onyx"
---

Configure Onyx to use Anthropic's Claude models, known for their excellent reasoning capabilities, ethical alignment, and long context windows. Claude models excel at complex analysis, creative tasks, and maintaining helpful, harmless, and honest interactions.

## Available Models

Anthropic offers several Claude model variants:

### **Claude 3.5 Sonnet**
- **Performance**: Highest quality reasoning and analysis
- **Context Window**: 200K tokens
- **Best For**: Complex reasoning, analysis, creative writing
- **Speed**: Balanced performance

### **Claude 3 Opus**
- **Performance**: Most capable model for complex tasks
- **Context Window**: 200K tokens  
- **Best For**: Advanced reasoning, research, complex problem-solving
- **Speed**: Slower but highest quality

### **Claude 3 Haiku**
- **Performance**: Fast and efficient for simpler tasks
- **Context Window**: 200K tokens
- **Best For**: Quick responses, content moderation, simple analysis
- **Speed**: Fastest response times

### **Model Recommendations**
- **Production Use**: Claude 3.5 Sonnet for best overall performance
- **Complex Analysis**: Claude 3 Opus for highest quality reasoning
- **High Volume**: Claude 3 Haiku for speed and cost efficiency

## Configuration Setup

### **1. Get Anthropic API Key**

1. Visit the [Anthropic Developer Console](https://console.anthropic.com/)
2. Sign up for an Anthropic account or sign in
3. Navigate to the **API Keys** section
4. Click **"Create Key"**
5. **Copy and securely store** the generated API key

<Warning>
**Security Note**

Keep your API key secure and never expose it in client-side code or public repositories. The key provides access to your Anthropic account and billing.
</Warning>

### **2. Configure in Onyx**

1. **Access Admin Dashboard**: Navigate to your Onyx admin panel
2. **Open LLM Configuration**: Click on the **"LLM"** tab in the sidebar
3. **Add Anthropic Provider**: Select **"Anthropic"** from the available providers
4. **Enter API Key**: Paste your API key in the designated field
5. **Select Model**: Choose from Claude 3.5 Sonnet, Claude 3 Opus, or Claude 3 Haiku
6. **Test Connection**: Verify the connection works correctly

![Anthropic Configuration](/assets/images/gen_ai/AnthropicLLMProvider.png)

### **3. Model Selection Guide**

| Model | Context Window | Speed | Cost | Best Use Cases |
|-------|----------------|-------|------|----------------|
| Claude 3.5 Sonnet | 200K tokens | Fast | Moderate | General use, analysis, creative tasks |
| Claude 3 Opus | 200K tokens | Slow | High | Complex reasoning, research |
| Claude 3 Haiku | 200K tokens | Very Fast | Low | Simple tasks, high volume |

## Key Features

### **Long Context Windows**
All Claude models support 200K token context windows, allowing for:
- **Large Document Analysis**: Process entire reports, papers, or codebases
- **Extended Conversations**: Maintain context across long discussions
- **Comprehensive Research**: Analyze multiple sources simultaneously

### **Ethical Alignment**
Claude models are trained with Constitutional AI principles:
- **Helpful**: Designed to be maximally helpful for legitimate tasks
- **Harmless**: Avoids generating harmful or dangerous content
- **Honest**: Acknowledges uncertainty and avoids hallucination

### **Advanced Reasoning**
Excellent performance on:
- **Analytical Tasks**: Data analysis, research synthesis
- **Creative Writing**: Stories, poetry, content creation
- **Code Analysis**: Understanding and explaining complex code
- **Problem Solving**: Multi-step reasoning and logic

## Advanced Configuration

### **Custom Parameters**

Configure Claude's behavior with these parameters:

```json
{
  "max_tokens": 4096,
  "temperature": 0.7,
  "top_p": 0.9,
  "top_k": 40,
  "stop_sequences": ["Human:", "Assistant:"]
}
```

**Parameter Details:**
- **max_tokens**: Maximum response length (up to 4096)
- **temperature**: Controls randomness (0.0-1.0)
- **top_p**: Nucleus sampling parameter
- **top_k**: Top-k sampling limit
- **stop_sequences**: Text patterns that stop generation

### **Rate Limits**

Anthropic implements rate limiting based on your plan:

**Free Tier:**
- Limited requests per day
- Access to Claude 3 Haiku
- Basic support

**Pro Plan:**
- Higher rate limits
- Access to all Claude models
- Priority support

**Enterprise:**
- Custom rate limits
- Enhanced security features
- Dedicated support

## Cost Management

### **Token-Based Billing**

Anthropic charges based on input and output tokens:
- **Input Tokens**: Text sent to Claude
- **Output Tokens**: Text generated by Claude
- **Different rates** for different models

### **Cost Optimization Strategies**

1. **Choose Appropriate Models**: Use Haiku for simpler tasks
2. **Optimize Prompts**: Clear, concise prompts reduce token usage
3. **Set Token Limits**: Control maximum response length
4. **Monitor Usage**: Track consumption through Anthropic Console
5. **Batch Requests**: Group similar requests when possible

### **Usage Monitoring**

Track your usage through:
- **Anthropic Console**: Real-time usage and billing
- **API Response Headers**: Token count information
- **Onyx Analytics**: Internal usage tracking

## Security and Privacy

### **Data Handling**
- **No Training**: Your data is not used to train Anthropic models
- **Temporary Storage**: Conversations may be stored briefly for safety
- **Enterprise Options**: Enhanced privacy controls available

### **API Security**
- **HTTPS**: All API communication uses TLS encryption
- **Key Management**: Rotate API keys regularly
- **Access Control**: Limit key access to necessary personnel

### **Content Safety**
- **Built-in Filtering**: Automatic harmful content detection
- **Constitutional AI**: Ethical guidelines built into model behavior
- **Monitoring**: Abuse detection and prevention systems

## Troubleshooting

### **Common Issues**

**Authentication Errors**
```
401 Unauthorized
```
- Verify API key is correct and active
- Check if key has been revoked or expired
- Ensure proper authentication header format

**Rate Limit Exceeded**
```
429 Too Many Requests
```
- Implement exponential backoff
- Consider upgrading your Anthropic plan
- Optimize request frequency

**Model Access Issues**
```
403 Forbidden
```
- Verify your plan includes access to the requested model
- Check if model name is spelled correctly
- Confirm account is in good standing

### **Performance Issues**

**Slow Response Times**
- Try Claude 3 Haiku for faster responses
- Reduce max_tokens parameter
- Check network connectivity

**Quality Issues**
- Adjust temperature for more/less creative responses
- Provide more specific instructions in prompts
- Use examples to guide desired output format

### **Content Filtering**

If responses are being filtered:
- Review prompt for potentially harmful content
- Rephrase requests to be clearer and more specific
- Ensure requests comply with Anthropic's usage policies

## Best Practices

### **Prompt Engineering for Claude**

**Effective Prompting:**
- **Use XML Tags**: Claude responds well to structured XML-like tags
- **Be Explicit**: Clear instructions work better than implied requests
- **Provide Context**: Background information improves response quality
- **Use Examples**: Show desired format with concrete examples

**Example Structure:**
```
<task>
Analyze the following document for key themes
</task>

<document>
[Your document content here]
</document>

<format>
Please format your response as:
1. Theme 1: [Description]
2. Theme 2: [Description]
3. Theme 3: [Description]
</format>
```

### **Production Deployment**

**Reliability:**
- **Error Handling**: Implement robust error handling and retries
- **Monitoring**: Track response times and error rates
- **Fallbacks**: Have backup models or strategies
- **Logging**: Log requests and responses for debugging

**Scaling:**
- **Connection Pooling**: Reuse connections efficiently
- **Async Requests**: Use asynchronous processing for high volume
- **Caching**: Cache responses for repeated queries
- **Load Balancing**: Distribute requests across multiple API keys if needed

## Integration Examples

### **Basic Claude Integration**

```python
import anthropic

client = anthropic.Anthropic(api_key="your-api-key")

response = client.messages.create(
    model="claude-3-5-sonnet-20241022",
    max_tokens=1024,
    messages=[
        {"role": "user", "content": "Explain quantum computing in simple terms"}
    ]
)

print(response.content[0].text)
```

### **Advanced Configuration**

```python
import anthropic

client = anthropic.Anthropic(api_key="your-api-key")

response = client.messages.create(
    model="claude-3-5-sonnet-20241022",
    max_tokens=2048,
    temperature=0.3,
    system="You are a helpful research assistant specializing in technical analysis.",
    messages=[
        {
            "role": "user", 
            "content": "Analyze the pros and cons of microservices architecture"
        }
    ]
)

print(response.content[0].text)
```

### **Error Handling**

```python
import anthropic

client = anthropic.Anthropic(api_key="your-api-key")

try:
    response = client.messages.create(
        model="claude-3-5-sonnet-20241022",
        max_tokens=1024,
        messages=[{"role": "user", "content": "Hello Claude!"}]
    )
    print(response.content[0].text)
except anthropic.AuthenticationError:
    print("Authentication failed. Check your API key.")
except anthropic.RateLimitError:
    print("Rate limit exceeded. Please wait and try again.")
except Exception as e:
    print(f"An error occurred: {e}")
```

## Comparison with Other Providers

### **Claude vs GPT-4**
- **Context Window**: Claude (200K) vs GPT-4 (8K-128K)
- **Reasoning**: Both excellent, Claude often more thorough
- **Safety**: Claude has more built-in safety features
- **Speed**: GPT-4o generally faster than Claude 3.5 Sonnet

### **When to Choose Claude**
- **Long Documents**: Superior handling of large context
- **Ethical Considerations**: Built-in constitutional AI principles
- **Detailed Analysis**: Excels at thorough, nuanced analysis
- **Creative Writing**: Strong performance on creative tasks

## Getting Help

For Anthropic-specific support:
- **Anthropic Documentation**: [https://docs.anthropic.com](https://docs.anthropic.com)
- **Support**: Available through Anthropic Console
- **Community**: Discord community for developers

For Onyx integration help:
- **Onyx Slack**: Join our [community](https://join.slack.com/t/onyx-dot-app/shared_invite/zt-34lu4m7xg-TsKGO6h8PDvR5W27zTdyhA)
- **Documentation**: Return to [LLM Overview](../getting_started/llm)
- **Issues**: Report problems on [GitHub](https://github.com/onyx-dot-app/onyx)

Claude's combination of high-quality reasoning, ethical alignment, and long context windows makes it an excellent choice for applications requiring thoughtful analysis and comprehensive understanding. 